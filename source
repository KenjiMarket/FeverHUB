local player = game.Players.LocalPlayer
local userInput = game:GetService("UserInputService")
local runService = game:GetService("RunService")

-- Whitelist check
local whitelist = {"totsnotaaltaccount45", "7992955106", "8036445383", "namuicflask", "4370702952"} -- Replace with your username or UserId(s)
local function isWhitelisted()
    for _, allowedUser in pairs(whitelist) do
        if player.Name == allowedUser or tostring(player.UserId) == allowedUser then
            return true
        end
    end
    return false
end

-- Kick if not whitelisted
if not isWhitelisted() then
    player:Kick("You're not whitelisted for this script XD")
    return -- Stop the script if the player is not whitelisted
end

-- States
local noclip = false
local espEnabled = false
local espHighlights = {}
local playerSpeed = 16 -- Default speed
local jitterEnabled = false
local spinEnabled = false
local biggerHitboxes = false
local tpToPlayerTarget = nil

-- Function to disable all features
local function disableAllFeatures()
    noclip = false
    for _, highlight in pairs(espHighlights) do
        highlight:Destroy()
    end
    espHighlights = {}
    espEnabled = false
    jitterEnabled = false
    spinEnabled = false
    biggerHitboxes = false
end

-- Noclip Logic
local function enableNoclip()
    local character = player.Character
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end

local function disableNoclip()
    local character = player.Character
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end
end

-- ESP Logic
local function enableESP()
    for _, otherPlayer in pairs(game.Players:GetPlayers()) do
        if otherPlayer ~= player then
            local character = otherPlayer.Character
            if character then
                local highlight = Instance.new("Highlight")
                highlight.Parent = character
                highlight.Adornee = character
                highlight.FillColor = Color3.new(1, 1, 1) -- White fill
                highlight.OutlineColor = Color3.new(1, 1, 1) -- White outline
                espHighlights[otherPlayer] = highlight
            end
        end
    end
end

local function disableESP()
    for _, highlight in pairs(espHighlights) do
        highlight:Destroy()
    end
    espHighlights = {}
end

-- Jitter Logic (Smooth Circle Motion)
local function jitter()
    local angle = 0
    local radius = 1.1 -- Radius of the circle (22 studs)
    while jitterEnabled and player.Character and player.Character:FindFirstChild("HumanoidRootPart") do
        local rootPart = player.Character.HumanoidRootPart
        angle = angle + 0.1 -- Increment angle for smooth motion
        if angle >= 360 then
            angle = 0 -- Reset angle after full circle
        end
        local offset = Vector3.new(math.cos(angle) * radius, 0, math.sin(angle) * radius)
        rootPart.CFrame = rootPart.CFrame:ToWorldSpace(CFrame.new(offset))
        wait(0.03) -- Adjust for smoothness
    end
end

-- Spin Logic (Faster Rotation)
local function spin()
    while spinEnabled and player.Character and player.Character:FindFirstChild("HumanoidRootPart") do
        local rootPart = player.Character.HumanoidRootPart
        rootPart.CFrame = rootPart.CFrame * CFrame.Angles(0, math.rad(20), 0) -- Increased rotation speed
        wait()
    end
end

-- Speed Changer Logic
local function changeSpeed(newSpeed)
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = tonumber(newSpeed) or 16
    end
end

-- Bigger Hitboxes Logic
local function enableBiggerHitboxes()
    for _, otherPlayer in pairs(game.Players:GetPlayers()) do
        if otherPlayer.Character then
            local character = otherPlayer.Character
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.Size = part.Size * 2 -- Double the size of each part
                end
            end
        end
    end
end

local function disableBiggerHitboxes()
    for _, otherPlayer in pairs(game.Players:GetPlayers()) do
        if otherPlayer.Character then
            local character = otherPlayer.Character
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.Size = part.Size / 2 -- Reset the size of each part
                end
            end
        end
    end
end

-- TP to Player Logic
local function tpToPlayer()
    if tpToPlayerTarget and tpToPlayerTarget.Character and tpToPlayerTarget.Character:FindFirstChild("HumanoidRootPart") then
        player.Character:MoveTo(tpToPlayerTarget.Character.HumanoidRootPart.Position)
    end
end

-- Bring All Logic
local function bringAll()
    local playerRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    if playerRoot then
        for _, otherPlayer in pairs(game.Players:GetPlayers()) do
            if otherPlayer ~= player and otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart") then
                otherPlayer.Character.HumanoidRootPart.CFrame = playerRoot.CFrame
            end
        end
    end
end

-- Create GUI
local function createGUI()
    disableAllFeatures()
    
    local gui = Instance.new("ScreenGui")
    gui.Name = "FeverHUB"
    gui.Parent = player:WaitForChild("PlayerGui")
    
    -- Main GUI Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 400, 0, 300) -- Rectangle shape
    mainFrame.Position = UDim2.new(0.5, -200, 0.5, -150) -- Centered
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame.Visible = false
    mainFrame.Parent = gui

    -- Rounded Corners for Main Frame
    local mainFrameCorner = Instance.new("UICorner")
    mainFrameCorner.CornerRadius = UDim.new(0, 12)
    mainFrameCorner.Parent = mainFrame

    -- Glow Outline for Main Frame
    local glow = Instance.new("UIStroke")
    glow.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    glow.Color = Color3.fromRGB(0, 255, 255)
    glow.Thickness = 2
    glow.Transparency = 0.5
    glow.Parent = mainFrame

    -- Title Bar
    local titleBar = Instance.new("Frame")
    titleBar.Size = UDim2.new(1, 0, 0, 40)
    titleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    titleBar.Parent = mainFrame

    -- Rounded Corners for Title Bar
    local titleBarCorner = Instance.new("UICorner")
    titleBarCorner.CornerRadius = UDim.new(0, 12)
    titleBarCorner.Parent = titleBar

    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(0, 200, 0, 30)
    titleLabel.Position = UDim2.new(0.5, -100, 0.5, -15)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 18
    titleLabel.Text = "FeverHUB"
    titleLabel.TextXAlignment = Enum.TextXAlignment.Center
    titleLabel.Parent = titleBar

    -- Close Button
    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -35, 0.5, -15)
    closeButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.Font = Enum.Font.GothamBold
    closeButton.TextSize = 16
    closeButton.Parent = titleBar

    -- Rounded Corners for Close Button
    local closeButtonCorner = Instance.new("UICorner")
    closeButtonCorner.CornerRadius = UDim.new(0, 8)
    closeButtonCorner.Parent = closeButton

    -- Open Button (Draggable)
    local openButton = Instance.new("TextButton")
    openButton.Size = UDim2.new(0, 100, 0, 40)
    openButton.Position = UDim2.new(0, 10, 0, 10)
    openButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    openButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    openButton.Font = Enum.Font.GothamBold
    openButton.TextSize = 16
    openButton.Text = "Open"
    openButton.Parent = gui

    -- Rounded Corners for Open Button
    local openButtonCorner = Instance.new("UICorner")
    openButtonCorner.CornerRadius = UDim.new(0, 8)
    openButtonCorner.Parent = openButton

    -- Dragging functionality
    local dragging
    local dragInput
    local dragStart
    local startPos

    openButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = openButton.Position
        end
    end)

    openButton.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    userInput.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            openButton.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)

    userInput.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)

    -- Main Tab Logic (for toggles)
    local mainTab = Instance.new("Frame")
    mainTab.Size = UDim2.new(1, 0, 1, 0)
    mainTab.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    mainTab.Position = UDim2.new(0, 0, 0, 40) -- Just below the title bar
    mainTab.Parent = mainFrame

    -- Toggle Buttons for Main Tab
    local noclipButton = Instance.new("TextButton")
    noclipButton.Size = UDim2.new(0, 250, 0, 40)
    noclipButton.Position = UDim2.new(0.5, -125, 0, 10)
    noclipButton.Text = "Toggle Noclip"
    noclipButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    noclipButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    noclipButton.Font = Enum.Font.GothamBold
    noclipButton.TextSize = 14
    noclipButton.Parent = mainTab

    -- Toggle Button for ESP
    local espButton = Instance.new("TextButton")
    espButton.Size = UDim2.new(0, 250, 0, 40)
    espButton.Position = UDim2.new(0.5, -125, 0, 60)
    espButton.Text = "Toggle ESP"
    espButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    espButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    espButton.Font = Enum.Font.GothamBold
    espButton.TextSize = 14
    espButton.Parent = mainTab

    -- Toggle Button for Speed
    local speedButton = Instance.new("TextButton")
    speedButton.Size = UDim2.new(0, 250, 0, 40)
    speedButton.Position = UDim2.new(0.5, -125, 0, 110)
    speedButton.Text = "Change Speed"
    speedButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    speedButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    speedButton.Font = Enum.Font.GothamBold
    speedButton.TextSize = 14
    speedButton.Parent = mainTab

    -- Toggle Button for Spin
    local spinButton = Instance.new("TextButton")
    spinButton.Size = UDim2.new(0, 250, 0, 40)
    spinButton.Position = UDim2.new(0.5, -125, 0, 160)
    spinButton.Text = "Toggle Spin"
    spinButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    spinButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    spinButton.Font = Enum.Font.GothamBold
    spinButton.TextSize = 14
    spinButton.Parent = mainTab

    -- Add Main Tab button functionalities
    noclipButton.MouseButton1Click:Connect(function()
        noclip = not noclip
        if noclip then
            enableNoclip()
        else
            disableNoclip()
        end
    end)

    espButton.MouseButton1Click:Connect(function()
        espEnabled = not espEnabled
        if espEnabled then
            enableESP()
        else
            disableESP()
        end
    end)

    speedButton.MouseButton1Click:Connect(function()
        local speed = playerSpeed -- Default speed
        -- Here, you can change the speed dynamically, like showing an input dialog
        changeSpeed(speed)
    end)

    spinButton.MouseButton1Click:Connect(function()
        spinEnabled = not spinEnabled
        if spinEnabled then
            spin()
        end
    end)

    -- Extras Tab Logic
    local extrasTab = Instance.new("Frame")
    extrasTab.Size = UDim2.new(1, 0, 1, 0)
    extrasTab.Position = UDim2.new(0, 0, 0, 40) -- Just below the title bar
    extrasTab.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    extrasTab.Parent = mainFrame

    -- Toggle Buttons for Extras Tab
    -- Tp to Player Button
    local tpButton = Instance.new("TextButton")
    tpButton.Size = UDim2.new(0, 250, 0, 40)
    tpButton.Position = UDim2.new(0.5, -125, 0, 10)
    tpButton.Text = "Teleport to Player"
    tpButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    tpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    tpButton.Font = Enum.Font.GothamBold
    tpButton.TextSize = 14
    tpButton.Parent = extrasTab

    -- Bigger Hitboxes Button
    local hitboxButton = Instance.new("TextButton")
    hitboxButton.Size = UDim2.new(0, 250, 0, 40)
    hitboxButton.Position = UDim2.new(0.5, -125, 0, 60)
    hitboxButton.Text = "Toggle Bigger Hitboxes"
    hitboxButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    hitboxButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    hitboxButton.Font = Enum.Font.GothamBold
    hitboxButton.TextSize = 14
    hitboxButton.Parent = extrasTab

    -- Add functionality for extras buttons
    tpButton.MouseButton1Click:Connect(function()
        local targetPlayer = game.Players:GetPlayers()[2]  -- Skipping the local player
        if targetPlayer then
            tpToPlayerTarget = targetPlayer
            tpToPlayer()
        end
    end)

    hitboxButton.MouseButton1Click:Connect(function()
        biggerHitboxes = not biggerHitboxes
        if biggerHitboxes then
            enableBiggerHitboxes()
        else
            disableBiggerHitboxes()
        end
    end)

    -- Show GUI button
    openButton.MouseButton1Click:Connect(function()
        mainFrame.Visible = not mainFrame.Visible
    end)

    -- Close GUI button functionality
    closeButton.MouseButton1Click:Connect(function()
        gui:Destroy()
    end)
end

-- Create the GUI
createGUI()
